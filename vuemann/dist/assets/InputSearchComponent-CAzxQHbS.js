import{Y as T,Z as $,h as F,$ as m,g as d,X as z,a0 as H,x as b,o as f,w,j as K,v,c as U,i as C,u as r,t as I,a as g,y as N,z as Y,a1 as s,H as j,k as A,C as P}from"./index-CFtw_ocM.js";const X=["id","name"],Z=["for"],G={key:1,class:"text-center my-5 fw-700 color-neutral-500"},J=500,Q={__name:"InputSearchComponent",props:T({name:{type:String,required:!0},label:{type:String,required:!0},cb:{type:Function,required:!0},minLenght:{type:Number,default:1},minLenghtError:{type:String,default:void 0},pattern:{type:RegExp,default:void 0},displayError:{type:Boolean,default:!0},form:{type:String,default:void 0},required:{type:Boolean,default:!1},noResult:{type:String,default:void 0}},{modelValue:{type:String,default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(e,{expose:x}){const n=e,l=$(e,"modelValue");F(l,t=>{t.length>0||(m.clearError(n.name),a.value=[])});const i=d(!1),h=d(),B=z(),a=d([]),y=!!B.default;let o;const p=async()=>{if(l.value.length===0||typeof l.value!="string"){S();return}i.value=!0,m.clearError(n.name),o!==null&&clearTimeout(o),o=setTimeout(q,J)},q=async()=>{if(l.value.length<n.minLenght){D();return}try{a.value=await n.cb(l.value),y&&a.value!==void 0&&u(a.value.length>0||n.noResult!==void 0)}catch(t){a.value=[],console.flash.error("Erreur lors de la recherche:",t)}finally{i.value=!1}},D=()=>{l.value.length>0&&m.addflash.error(n.name,n.minLenghtError??I("input_search.error_min_length",{length:n.minLenght})),S()},S=()=>{a.value=[],i.value=!1,u(!1)},u=t=>{h.value.toggle(t)},L=t=>{a.value=t,y&&u(a.value.length>0)},R=(t="")=>{l.value=t},k=d(),V=()=>{k.value.focus()},M=t=>n.pattern===void 0||n.pattern.test(String.fromCodePoint(t.keyCode))?!0:(t.preventDefault(),!1);return H(()=>{o!==void 0&&clearTimeout(o)}),x({runCallback:p,toggleDropdown:u,setItems:L,setSearch:R,focus:V}),(t,c)=>(f(),b(P,{ref_key:"dropdown",ref:h,classes:"left",autoToggle:!1},{button:w(()=>[g("div",{class:N(["input-search",{searching:i.value}])},[Y(g("input",{ref_key:"inputSearch",ref:k,id:r(s).getInputName(e.name,e.form),name:r(s).getInputName(e.name,e.form),class:"form-input input",type:"search","onUpdate:modelValue":c[0]||(c[0]=E=>l.value=E),onInput:p,onKeypress:M,onFocus:c[1]||(c[1]=E=>u(l.value.length>0&&(a.value?.length>0||e.noResult!==void 0))),autocomplete:"off",placeholder:""},null,40,X),[[j,l.value]]),g("label",{for:r(s).getInputName(e.name,e.form),class:N(["form-label",{required:e.required}])},C(e.label),11,Z),e.displayError===!0&&r(m).hasError(r(s).getInputName(e.name,e.form))?(f(),b(A,{key:0,name:r(s).getInputName(e.name,e.form)},null,8,["name"])):v("",!0)],2)]),items:w(()=>[a.value.length>0?K(t.$slots,"default",{key:0,items:a.value}):v("",!0),e.noResult&&a.value.length===0?(f(),U("p",G,C(r(I)(e.noResult)),1)):v("",!0)]),_:3},512))}};export{Q as _};
